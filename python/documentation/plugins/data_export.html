

<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data Export (BETA) &#8212; VectorNav SDK 0.22.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/cloud.css?v=36acb9b5" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=a6d58504" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script src="../_static/documentation_options.js?v=5686f5df"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>

    
    
     
        <script src="../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../_static/cloud.base.js"></script>
    

    
     
        <script src="../_static/cloud.js"></script>
    

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Firmware Programmer" href="firmware_programmer.html" />
    <link rel="prev" title="Calibration (BETA)" href="calibration.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="firmware_programmer.html" title="Firmware Programmer"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="calibration.html" title="Calibration (BETA)"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../Documentation.html">VectorNav SDK 0.22.0 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Plugins</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Data Export (<em>BETA</em>)</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="data-export-beta">
<span id="pythondataexportpage"></span><h1>Data Export (<em>BETA</em>)<a class="headerlink" href="#data-export-beta" title="Link to this heading">¶</a></h1>
<p>The DataExport plugin provides the necessary classes to export data form the sensor directly to various file formats such as Csv, Ascii, and Rinex files. In addition, the same classes can be used to export data from a file.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This plugin is currently in <em>BETA</em> and may be subject to interface changes in the future.</p>
</div>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p>The DataExport plugin works via the Exporter class. It is an abstract base class where other exporters like <code class="xref py py-class docutils literal notranslate"><span class="pre">ExporterCsv</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ExporterAscii</span></code>, etc.. are derived from insuring a common interface. The mechanism from a file and in real-time are slightly different. The examples of both are in the subsequent sections.</p>
<section id="exporting-in-real-time">
<h3>Exporting in Real-Time<a class="headerlink" href="#exporting-in-real-time" title="Link to this heading">¶</a></h3>
<p>To export data from a CSV in real-time requires the following imports</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">vectornav</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">vectornav.Plugins</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataExport</span>
</pre></div>
</div>
<p>We can create a ExporterCsv class which has two arguments – the folder to log the CSV files, and whether to include system timestamps (the time reported by the computer when a packet of data was received). The ExporterCsv class requires a <strong>folder</strong> not a file path. This is because each unique packet output by the sensor will generate its own CSV file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">csvExporter</span> <span class="o">=</span> <span class="n">DataExport</span><span class="o">.</span><span class="n">ExporterCsv</span><span class="p">(</span><span class="n">outputDirectory</span><span class="p">)</span>
</pre></div>
</div>
<p>Before exporting data from the sensor, the exporter needs to provide its internal queue to a subscriber of your choice. For all data from the sensor subscribe to both Ascii and Binary packets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sensor</span> <span class="o">=</span> <span class="n">Sensor</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3. Add a subscriber to all binary and ASCII packets</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">sensor</span><span class="o">.</span><span class="n">subscribeToMessage</span><span class="p">(</span>
        <span class="n">csvExporter</span><span class="o">.</span><span class="n">getQueuePtr</span><span class="p">(),</span>
        <span class="n">Sensor</span><span class="o">.</span><span class="n">BinaryOutputMeasurements</span><span class="p">(),</span>
        <span class="n">Sensor</span><span class="o">.</span><span class="n">FaSubscriberFilterType</span><span class="o">.</span><span class="n">AnyMatch</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">latestError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">latestError</span><span class="si">}</span><span class="s2"> encountered when subscribing.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">sensor</span><span class="o">.</span><span class="n">subscribeToMessage</span><span class="p">(</span>
        <span class="n">csvExporter</span><span class="o">.</span><span class="n">getQueuePtr</span><span class="p">(),</span> <span class="s2">&quot;VN&quot;</span><span class="p">,</span> <span class="n">Sensor</span><span class="o">.</span><span class="n">AsciiSubscriberFilterType</span><span class="o">.</span><span class="n">StartsWith</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">latestError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">latestError</span><span class="si">}</span><span class="s2"> encountered when subscribing.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span>

</pre></div>
</div>
<p>With the subscribers setup, connect to the sensor and begin logging:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sensor</span><span class="o">.</span><span class="n">autoConnect</span><span class="p">(</span><span class="n">portName</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">csvExporter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logging to &quot;</span><span class="p">,</span> <span class="n">outputDirectory</span><span class="p">)</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">while</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>

    <span class="c1"># Handle asynchronous errors</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">sensor</span><span class="o">.</span><span class="n">throwIfAsyncError</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">asyncError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received async error: </span><span class="si">{</span><span class="n">asyncError</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">);</span>

<span class="n">csvExporter</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="exporting-from-a-file">
<h3>Exporting from a file<a class="headerlink" href="#exporting-from-a-file" title="Link to this heading">¶</a></h3>
<p>Exporting data from a file requires quite a few pieces. First create a sensor with the <code class="xref py py-class docutils literal notranslate"><span class="pre">MeasQueueMode`</span></code> set to Off.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pushToCompositeData</span> <span class="o">=</span> <span class="n">Sensor</span><span class="o">.</span><span class="n">MeasQueueMode</span><span class="o">.</span><span class="n">Off</span>
<span class="n">sensor</span> <span class="o">=</span> <span class="n">Sensor</span><span class="p">(</span><span class="n">pushToCompositeData</span><span class="p">)</span>
</pre></div>
</div>
<p>Create the exporters to your desired file types and subscribe the sensor to their Queue pointers</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">asciiExporter</span> <span class="o">=</span> <span class="n">DataExport</span><span class="o">.</span><span class="n">ExporterAscii</span><span class="p">(</span><span class="n">outputPath</span><span class="p">,</span> <span class="n">DataExport</span><span class="o">.</span><span class="n">PacketQueueMode</span><span class="o">.</span><span class="n">Retry</span><span class="p">)</span>
<span class="n">sensor</span><span class="o">.</span><span class="n">subscribeToMessage</span><span class="p">(</span>
    <span class="n">asciiExporter</span><span class="o">.</span><span class="n">getQueuePtr</span><span class="p">(),</span> <span class="s2">&quot;VN&quot;</span><span class="p">,</span> <span class="n">Sensor</span><span class="o">.</span><span class="n">AsciiSubscriberFilterType</span><span class="o">.</span><span class="n">StartsWith</span>
<span class="p">)</span>

<span class="n">csvExporter</span> <span class="o">=</span> <span class="n">DataExport</span><span class="o">.</span><span class="n">ExporterCsv</span><span class="p">(</span><span class="n">outputPath</span><span class="p">,</span> <span class="n">DataExport</span><span class="o">.</span><span class="n">PacketQueueMode</span><span class="o">.</span><span class="n">Retry</span><span class="p">)</span>
<span class="n">sensor</span><span class="o">.</span><span class="n">subscribeToMessage</span><span class="p">(</span>
    <span class="n">csvExporter</span><span class="o">.</span><span class="n">getQueuePtr</span><span class="p">(),</span>
    <span class="n">Sensor</span><span class="o">.</span><span class="n">BinaryOutputMeasurements</span><span class="p">(),</span>
    <span class="n">Sensor</span><span class="o">.</span><span class="n">FaSubscriberFilterType</span><span class="o">.</span><span class="n">AnyMatch</span>
<span class="p">)</span>
<span class="n">sensor</span><span class="o">.</span><span class="n">subscribeToMessage</span><span class="p">(</span>
    <span class="n">csvExporter</span><span class="o">.</span><span class="n">getQueuePtr</span><span class="p">(),</span> <span class="s2">&quot;VN&quot;</span><span class="p">,</span> <span class="n">Sensor</span><span class="o">.</span><span class="n">AsciiSubscriberFilterType</span><span class="o">.</span><span class="n">StartsWith</span>
<span class="p">)</span>

</pre></div>
</div>
<p>Start the desired exporter threads.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">asciiExporter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>Connect the sensor to the input file and monitor for errors.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sensor</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>

    <span class="c1"># Handle asynchronous errors</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">sensor</span><span class="o">.</span><span class="n">throwIfAsyncError</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">vectornav</span><span class="o">.</span><span class="n">FileReadFailed</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">asyncError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received async error: </span><span class="si">{</span><span class="n">asyncError</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">sensor</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</pre></div>
</div>
<p>Lastly, stop the exporter threads</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">asciiExporter</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="api">
<h2>API<a class="headerlink" href="#api" title="Link to this heading">¶</a></h2>
<p>The Python API for the DataExport plugin is modeled from the C++ API which can be found here:
<a class="reference external" href="../../../cpp/documentation/_api/namespace_VN__DataExport.html#namespace-vn-dataexport" title="(in VectorNav SDK)"><span class="xref std std-ref">DataExport</span></a></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<div class="sphinx-toc sphinxglobaltoc">
<h3><a href="../Documentation.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pages/migration_guide.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/key_functionality.html">Key Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/advanced_functionality.html">Advanced Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">VNSDK API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Plugins</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="calibration.html">Calibration (<em>BETA</em>)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Data Export (<em>BETA</em>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="firmware_programmer.html">Firmware Programmer</a></li>
<li class="toctree-l2"><a class="reference internal" href="logger.html">Logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="math.html">Math (<em>BETA</em>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="register_scan.html">Register Scan</a></li>
</ul>
</li>
</ul>
</div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="calibration.html"
                          title="Previous page">&larr; Calibration (<em>BETA</em>)</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="firmware_programmer.html"
                          title="Next page">&rarr; Firmware Programmer</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/plugins/data_export.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="firmware_programmer.html" title="Firmware Programmer"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="calibration.html" title="Calibration (BETA)"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../Documentation.html">VectorNav SDK 0.22.0 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >Plugins</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Data Export (<em>BETA</em>)</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, VectorNav Technologies.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>